<div id="users-table-container" data-table-container>
  {% if messages %}
    <section class="stack-gap">
      {% for message in messages %}
        <div class="notice{% if message.tags %} notice--{{ message.tags }}{% endif %}">{{ message }}</div>
      {% endfor %}
    </section>
  {% endif %}

  <section class="card card--table">
    <table class="table">
      <thead>
        <tr>
          <th>Usuário</th>
          <th>Nome</th>
          <th>Email</th>
          <th>Papel</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for membership in memberships %}
          <tr>
            <td>{{ membership.user.username }}</td>
            <td>{{ membership.user.get_full_name|default:"-" }}</td>
            <td>{{ membership.user.email|default:"-" }}</td>
            <td>{{ membership.get_role_display }}</td>
            <td>{% if membership.is_active %}Ativo{% else %}Inativo{% endif %}</td>
            <td class="table__actions">
              <button
                class="icon-btn"
                type="button"
                title="Editar"
                aria-label="Editar"
                data-open-edit
                data-membership-id="{{ membership.id }}"
                data-update-url="{% url 'users-update' membership.id %}"
                data-username="{{ membership.user.username }}"
                data-first-name="{{ membership.user.first_name }}"
                data-last-name="{{ membership.user.last_name }}"
                data-email="{{ membership.user.email }}"
                data-role="{{ membership.role }}"
                data-is-active="{% if membership.is_active %}1{% else %}0{% endif %}"
              >
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 17.25V20h2.75l8.11-8.11-2.75-2.75L4 17.25Zm13.71-8.04a1 1 0 0 0 0-1.42l-1.5-1.5a1 1 0 0 0-1.42 0l-1.17 1.17 2.75 2.75 1.34-1.3Z" fill="currentColor"/></svg>
              </button>
              {% if membership.user_id != request.user.id %}
                <form method="post" action="{% url 'users-delete' membership.id %}" data-platform-confirm="Remover acesso deste usuario da empresa?">
                  {% csrf_token %}
                  <button class="icon-btn" type="submit" title="Remover" aria-label="Remover">
                    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 7h12m-10 0 1 12h8l1-12M9 7V5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  </button>
                </form>
              {% endif %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6">Nenhum usuario interno cadastrado nesta empresa.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% include "partials/_table_pagination.html" %}
</div>
