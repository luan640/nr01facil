<div id="complaints-table-container" data-table-container>
  {% if messages %}
    <section class="stack-gap">
      {% for message in messages %}
        <div class="notice{% if message.tags %} notice--{{ message.tags }}{% endif %}">{{ message }}</div>
      {% endfor %}
    </section>
  {% endif %}

  <section class="card card--table">
    <table class="table">
      <thead>
        <tr>
          <th>Data/Hora</th>
          <th>Última atualização</th>
          <th>Tipo de denúncia</th>
          <th>Setor</th>
          <th>Denúncia</th>
          <th>Totem</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for complaint in complaints %}
          <tr>
            <td>{{ complaint.created_at|date:"d/m/Y H:i" }}</td>
            <td>{{ complaint.updated_at|date:"d/m/Y H:i" }}</td>
            <td>{{ complaint.complaint_type_label }}</td>
            <td>
              <span class="table__truncate table__truncate--sm" title="{{ complaint.department_label|default:'-' }}">
                {{ complaint.department_label|default:"-" }}
              </span>
            </td>
            <td>
              <span class="table__truncate" title="{{ complaint.complaint_detail|default:'-' }}">
                {{ complaint.complaint_detail|default:"-" }}
              </span>
            </td>
            <td>{{ complaint.totem.name|default:"-" }}</td>
            <td>
              <span class="status-badge status-badge--{{ complaint.complaint_status|lower }}">
                {{ complaint.get_complaint_status_display }}
              </span>
            </td>
            <td class="table__actions">
              <button class="icon-btn" type="button" data-open-complaint-history data-history-url="{% url 'complaints-history' complaint.id %}" title="Ver historico" aria-label="Ver historico">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M12 5a9 9 0 1 0 9 9h-2a7 7 0 1 1-7-7V5Zm1 1v6h5v2h-7V6h2Z" fill="currentColor"/>
                </svg>
              </button>
              <button class="icon-btn" type="button" data-open-edit-complaint data-update-url="{% url 'complaints-update' complaint.id %}" data-status="{{ complaint.complaint_status }}" title="Atualizar" aria-label="Atualizar">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M4 17.25V20h2.75l8.11-8.11-2.75-2.75L4 17.25Zm13.71-8.04a1 1 0 0 0 0-1.42l-1.5-1.5a1 1 0 0 0-1.42 0l-1.17 1.17 2.75 2.75 1.34-1.3Z" fill="currentColor"/>
                </svg>
              </button>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="8">Nenhuma denuncia registrada.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% include "partials/_table_pagination.html" %}
</div>
