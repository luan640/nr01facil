<div id="job-functions-table-container" data-table-container>
  {% if messages %}
    <section class="stack-gap">
      {% for message in messages %}
        <div class="notice{% if message.tags %} notice--{{ message.tags }}{% endif %}">{{ message }}</div>
      {% endfor %}
    </section>
  {% endif %}

  <section class="card card--table">
    <table class="table">
      <thead>
        <tr>
          <th>Nome</th>
          <th>GHE(s)</th>
          <th>Setor(es)</th>
          <th>Status</th>
          <th>Acoes</th>
        </tr>
      </thead>
      <tbody>
        {% for job_function in job_functions %}
          <tr>
            <td>{{ job_function.name }}</td>
            <td>
              {% with ghes=job_function.ghes.all %}
                {% if ghes %}
                  {% for ghe in ghes %}
                    {{ ghe.name }}{% if not forloop.last %}, {% endif %}
                  {% endfor %}
                {% else %}
                  -
                {% endif %}
              {% endwith %}
            </td>
            <td>
              {% with departments=job_function.departments.all %}
                {% if departments %}
                  {% for department in departments %}
                    {{ department.name }}{% if not forloop.last %}, {% endif %}
                  {% endfor %}
                {% else %}
                  -
                {% endif %}
              {% endwith %}
            </td>
            <td>{% if job_function.is_active %}Ativo{% else %}Inativo{% endif %}</td>
            <td class="table__actions">
              <button
                class="icon-btn"
                type="button"
                title="Editar"
                aria-label="Editar"
                data-open-edit-job-function
                data-update-url="{% url 'job-functions-update' job_function.id %}"
                data-name="{{ job_function.name }}"
                data-ghes="{% for ghe in job_function.ghes.all %}{{ ghe.id }}{% if not forloop.last %},{% endif %}{% endfor %}"
                data-departments="{% for department in job_function.departments.all %}{{ department.id }}{% if not forloop.last %},{% endif %}{% endfor %}"
                data-is-active="{% if job_function.is_active %}1{% else %}0{% endif %}"
              >
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 17.25V20h2.75l8.11-8.11-2.75-2.75L4 17.25Zm13.71-8.04a1 1 0 0 0 0-1.42l-1.5-1.5a1 1 0 0 0-1.42 0l-1.17 1.17 2.75 2.75 1.34-1.3Z" fill="currentColor"/></svg>
              </button>
              <form
                method="post"
                action="{% url 'job-functions-delete' job_function.id %}"
                data-job-function-toggle-form
                data-platform-confirm="{% if job_function.is_active %}Desativar{% else %}Ativar{% endif %} esta funcao?"
              >
                {% csrf_token %}
                <button class="icon-btn" type="submit" title="{% if job_function.is_active %}Desativar{% else %}Ativar{% endif %}" aria-label="{% if job_function.is_active %}Desativar{% else %}Ativar{% endif %}">
                  <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2Zm-5 9h10v2H7v-2Z" fill="currentColor"/></svg>
                </button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="5">Nenhuma funcao cadastrada.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
  {% include "partials/_table_pagination.html" %}
</div>
